{
  "hash": "051cc301241742233fe57a3bb66483b7",
  "result": {
    "markdown": "---\ntitle: \"Aquaculture in West Coast EEZs\"\ndescription: \"Create a function to understand areas suitable for Aquaculture in West Coast Exclusive Economic Zones.\"\nauthor:\n  - name: Hope Hahn\n    url: https://h-hahn.github.io/\n    affiliation: Master of Environmental Data Science Program\n    affiliation-url: https://ucsb-meds.github.io/\ndate: 12-14-2023\ncategories: [Quarto, R, MEDS, GIS]\ncitation:\n  url: https://h-hahn.github.io/blog/2023-12-14-aquaculture-eez\nformat: \n  html: \n    code-fold: true\nexecute: \n  warning: false\n  error: false\n  message: false\n#image: \n---\n\n\nFind the full analysis and access to the data [here](https://github.com/h-hahn/west-coast-eez)!\n\n## Introduction\n\nMarine aquaculture has the potential to play an important role in the global food supply as a more sustainable protein option than land-based meat production.[^1] Additionally, it creates opportunities to mitigate the the effects of climate change.[^2] Gentry et al. mapped the potential for marine aquaculture globally based on multiple constraints, including ship traffic, dissolved oxygen, bottom depth .[^3]\n\n[^1]: Hall, S. J., Delaporte, A., Phillips, M. J., Beveridge, M. & O'Keefe, M. Blue Frontiers: Managing the Environmental Costs of Aquaculture (The WorldFish Center, Penang, Malaysia, 2011).\n\n[^3]: Gentry, R. R., Froehlich, H. E., Grimm, D., Kareiva, P., Parke, M., Rust, M., Gaines, S. D., & Halpern, B. S. Mapping the global potential for marine aquaculture. *Nature Ecology & Evolution*, 1, 1317-1324 (2017).\n\n[^2]: Rubino, M. C. (2023) Policy Considerations for Marine Aquaculture in the United States, Reviews in Fisheries Science & Aquaculture, 31:1, 86-102, DOI: 10.1080/23308249.2022.2083452\n\nIt is important to understand what areas are suitable for commercial species to survive in order to make informed decisions about what species to involve in aquaculture. The purpose of this project is to inform what EEZs are suitable for marine aquaculture of different commercial species on the West Coast. To do this, I will create a function that will take depth and temparature conditions, species name, and the datasets to output maps appropriate for selected species.\n\n## Data\n\n**Sea Surface Temperature**\n\nI will use average annual sea surface temperature (SST) from the years 2008 to 2012 to characterize the average sea surface temperature within the region. The data used in this analysis was originally generated from [NOAA's 5km Daily Global Satellite Sea Surface Temperature Anomaly v3.1](https://coralreefwatch.noaa.gov/product/5km/index_5km_ssta.php).\n\n**Bathymetry**\n\nTo characterize the depth of the ocean I will use the [General Bathymetric Chart of the Oceans (GEBCO)](https://www.gebco.net/data_and_products/gridded_bathymetry_data/#area).[^4]\n\n[^4]: GEBCO Compilation Group (2022) GEBCO_2022 Grid (<doi:10.5285/e0f0bb80-ab44-2739-e053-6c86abc0289c>).\n\n**Exclusive Economic Zones**\n\nI will be designating maritime boundaries using Exclusive Economic Zones off of the west coast of US from [Marineregions.org](https://www.marineregions.org/eez.php).\n\n## Analysis\n\n***Data Preparation***\n\nIn order to create a function, I first manipulated the datasets to prepare them as inputs into the function. The datasets I manipulated were sea surface temperature (sst) and bathymetry rasters as well as data on the West Coast EEZs. I included sst data from 2008 to 2012 and took the mean sst during these years. Additionally, to work with both of the rasters together, it was important to match the CRS, extent, resolution and position of the sst and bathymetry rasters. The EEZ dataset was not necessary to alter to add to the function. This step allowed all three data objects to be used as inputs into the function.\n\n\n::: {.cell messages='false'}\n\n```{.r .cell-code}\n# load in packages\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(terra)\nlibrary(resample)\nlibrary(tmap)\nlibrary(maptiles)\n\n# read in west coast eez data\nwest_coast_eez <- st_read(\"data/wc_regions_clean.shp\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nReading layer `wc_regions_clean' from data source \n  `/Users/hopehahn/Documents/MEDS/WEBSITE/h-hahn.github.io/blog/2023-12-14-west-coast-eez/data/wc_regions_clean.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 5 features and 5 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -129.1635 ymin: 30.542 xmax: -117.097 ymax: 49.00031\nGeodetic CRS:  WGS 84\n```\n:::\n\n```{.r .cell-code}\n# read in sea surface temperature raster data\nsst_2008 <- rast(\"data/average_annual_sst_2008.tif\")\nsst_2009 <- rast(\"data/average_annual_sst_2009.tif\")\nsst_2010 <- rast(\"data/average_annual_sst_2010.tif\")\nsst_2011 <- rast(\"data/average_annual_sst_2011.tif\")\nsst_2012 <- rast(\"data/average_annual_sst_2012.tif\")\n\n# stack the sst rasters from 2008-2012\nsst_stack <- c(sst_2008,\n              sst_2009,\n              sst_2010,\n              sst_2011,\n              sst_2012)\n\n# read in bathymetry raster\nbathymetry <- rast(\"data/depth.tif\")\n\n### MEAN SST FROM 2008-2012\n# raster of mean SST from 2008-2012\nmean_sst_stack <- app(sst_stack, fun = mean)\n\n# convert SST data from Kelvin to Celsius\nmean_sst_stack_C <- mean_sst_stack - 273.15\n\n# change crs of sst_stack to match bathymetry raster crs\nsst_stack <- project(sst_stack, \"EPSG:4326\")\n\n### MATCH EXTENT, RESOLUTION, AND POSITION\n\n# crop bathymetry raster to match extent of SST raster\nbathymetry_crop <- crop(x = bathymetry, y = mean_sst_stack_C)\n\n# resample data to match resolution of sst data \nresample_bath <- terra::resample(bathymetry_crop, sst_stack, method = \"near\")\n```\n:::\n\n\n***Creating the Function***\n\nThe inputs of the function are the species name, the three datasets previously prepared, and the environmental conditions required for each species (depth and temperature ranges). The function works by reclassifying the sst and bathymetry rasters to binary values, assigning a 1 for areas with matching conditions, and a 0 for areas that are unsuitable conditions, based on inputs. Overlaying the two rasters creates a raster that shows areas which match both the depth and temperature conditions.\n\nThe function then calculates the area of suitable area within each West Coast EEZ, and it also divides by the total area within each region, to calculate what percent of the total area match suitable conditions in each EEZ.\n\nUsing these areas, the function uses `tmap` to plot maps of the total suitable area within each EEZ as well as the percent of suitable area in each EEZ.\n\n\n::: {.cell messages='false'}\n\n```{.r .cell-code}\n# create function to accomodate for other species\n# this function assumes that rasters are the same resolution, extent, and CRS\nsuitable_area <- function(species, eez_polygon, sst_rast, bath_rast, sst_lower, sst_upper, depth_lower, depth_upper) {\n  # reclassify\n  # create matrix to classify species sst ranges as 1 and everything else as NA\n  rcl_sst <- matrix(c(-Inf, sst_lower, NA, \n              sst_lower, sst_upper, 1,\n              sst_upper, Inf, NA), \n              ncol = 3, byrow = TRUE)\n  \n  # reclassify sst stack based off of previous matrix\n  sst_stack_rcl <- classify(sst_rast, rcl = rcl_sst)\n  \n  # create matrix to classify species depth ranges as 1 and everything else as NA\n  rcl_bath <- matrix(c(-Inf, depth_lower, NA,\n                     depth_lower, depth_upper, 1,\n                     depth_upper, Inf, NA),\n                     ncol = 3, byrow = TRUE)\n  \n  # reclasify bathymetry data based off of previous matrix\n  bath_rcl <- classify(bath_rast, rcl = rcl_bath)\n  \n  # find locations that satisfy both SST and depth conditions\n  satisfy_conditions <- lapp(c(sst_stack_rcl, bath_rcl), \"*\")\n\n  # ---------------------------------------------------------\n  \n  # create a mask of the oyster conditions that fall in west coast eez\n  mask_eez <- mask(satisfy_conditions, eez_polygon)\n\n  # rasterize data because its vector data\n  # use extent of depth raster\n  eez_rast <- terra::rasterize(eez_polygon, mask_eez, field = \"rgn\")\n\n  # find area within each EEZ\n  area <- expanse(mask_eez, unit = \"km\", zones = eez_rast)\n\n  # percent of each zone that is suitable\n  percent_suitable <- merge(eez_polygon, area, by.x = \"rgn\", by.y = \"zone\") %>% \n    mutate(percent_area = (area/area_km2)*100)\n\n  # ---------------------------------------------------------\n  \n  # plot map of total suitable area\n  tmap_mode(\"plot\")\n  \n  # plot total suitable area\n  total_area_map <- tm_shape(percent_suitable) +\n    tm_polygons(\"area\",\n                palette = \"YlOrBr\",\n                title = \"Total Suitable Area\",\n                lwd = 0.2) +\n    tm_basemap(\"OpenStreetMap\")  +\n    tm_layout(legend.frame = FALSE,\n            legend.outside = TRUE) +\n    tm_compass(type = \"8star\", # add compass\n               position = c(\"left\", \"bottom\"),\n               size = 3,\n               lwd = 0.2) + \n    tm_graticules(lwd = 0.2) +\n    tm_xlab(\"Longitude\", size = 0.6) +\n    tm_ylab(\"Latitude\", size = 0.6) +\n    tm_scalebar(position = c(\"right\", \"bottom\")) +\n    tm_title(text = paste(\"Suitable area for\", species)) \n \n  # ---------------------------------------------------------\n  \n  # plot map of percent suitable area per EEZ\n  # plot percent suitable area by region\n  \n  percent_area_map <- tm_shape(percent_suitable) +\n    tm_polygons(\"percent_area\",\n                palette = \"YlOrBr\",\n                title = \"Percent of suitable area in EEZ\",\n                lwd = 0.2)+\n    tm_basemap(\"OpenStreetMap\") +\n    tm_layout(legend.frame = FALSE,\n              legend.outside = TRUE,\n              scale = 0.8) +\n    tm_compass(type = \"8star\", \n              position = c(\"left\", \"bottom\"),\n              size = 3,\n              lwd = 0.2) + \n    tm_graticules(lwd = 0.2) +\n    tm_xlab(\"Longitude\", size = 0.6) +\n    tm_ylab(\"Latitude\", size = 0.6) +\n    tm_scalebar(position = c(\"right\", \"bottom\")) +\n    tm_title(text = paste(\"Percent of area suitable for\", species, \"per EEZ\")) \n  \n  # ---------------------------------------------------------\n  \n  # print the maps\n  print(total_area_map)\n  print(percent_area_map)\n\n}\n```\n:::\n\n\n## Results\n\nTo test this function, I inputted the suitable depth and temperature conditions for Dungeness crab, a commercial crab species. The resulting plot shows the amount of area in each EEZ region that match conditions conducive to Dungeness crab survival. These maps allow us to understand which EEZs are the most suitable for growing Dungeness crab in aquaculture (figure 1). I also wanted to test this function with another species, so I inputted depth and temperature conditions for Oysters (figure 2).\n\n\n::: {.cell messages='false'}\n\n```{.r .cell-code}\n# test function for suitable area for Metacarcinus magister (Dungeness crab)\nsuitable_area(species = \"Dungeness crab\",\n              eez_polygon = west_coast_eez, \n              sst_rast = mean_sst_stack_C, \n              bath_rast = resample_bath, \n              sst_lower = 3, \n              sst_upper = 19, \n              depth_lower = -360, \n              depth_upper = 0)\n\n# test function for suitable area for oysters\nsuitable_area(species = \"Oysters\",\n              eez_polygon = west_coast_eez, \n              sst_rast = mean_sst_stack_C, \n              bath_rast = resample_bath, \n              sst_lower = 11, \n              sst_upper = 30, \n              depth_lower = -70, \n              depth_upper = 0)\n```\n:::\n\n\n![Figure 1a: Map displaying total area suitable for Dungeness crab within each EEZ region](totalcrab.png)\n\n![Figure 1b: Map displaying percent area suitable for Dungeness crab out of whole EEZ region](percentcrab.png)\n\n![Figure 2a: Map displaying total area suitable for oysters within each EEZ region](totaloyster.png)\n\n![Figure 2b: Map displaying percent area suitable for oyster out of whole EEZ region](percentoyster.png)\n\n## Discussion\n\nBecause this function creates maps based on any inputted species, it is versatile in reproducing graphs across any commercial species. This is useful in streamlining the process of determining suitable aquaculture areas. However, there are a few limitations to this function. First, the datasets used as inputs for this function are very specific, and must be manipulated prior to using in the function. If using the same datasets that I did in the analysis, it is important to prepare them by transforming CRS, extent, position, and resolution in the same ways that I did. If using different datasets, the EEZ data must be vector data, and the bathymetry and sst data must be rasters that match in CRS, extent, position, and resolution.\n\nThis function also only creates maps for West Coast EEZs and does not account for conditions such as 3D complexity, substrate, nutrients, etc. It only accounts for depth and temperature. Many aquatic species depend on different environmental factors such as substrate and nutrients. In the context of aquaculture, the environment can be manipulated to accomodate for such factors, but in this case, we must also understand the environmental implications of manipulating natural resources.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}